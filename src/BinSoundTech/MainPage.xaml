<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:BinSoundTech.ViewModels"
             xmlns:conv="clr-namespace:BinSoundTech.Converters"
             x:Class="BinSoundTech.MainPage"
             x:DataType="vm:MainPageViewModel"
             Title="Binaural Sound Tech">

    <ContentPage.Resources>
        <conv:BoolToOpacityConverter x:Key="BoolToOpacityConverter" />
    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">
            
            <!-- Header -->
            <Label Text="Binaural Panning Controls"
                   FontSize="24"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   SemanticProperties.HeadingLevel="Level1" />

            <!-- Loading Status -->
            <Label Text="{Binding LoadingStatus}"
                   FontSize="14"
                   TextColor="Gray"
                   HorizontalOptions="Center"
                   Opacity="{Binding IsLoadingHrtf, Converter={StaticResource BoolToOpacityConverter}}" />

            <!-- Direction Indicator -->
            <Frame BackgroundColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                   Padding="15"
                   CornerRadius="10"
                   HorizontalOptions="Center">
                <Label Text="{Binding DirectionDescription}"
                       FontSize="18"
                       TextColor="White"
                       HorizontalOptions="Center" />
            </Frame>

            <!-- Azimuth Control -->
            <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2D2D2D}"
                   Padding="20"
                   CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Azimuth (Left/Right)"
                           FontSize="18"
                           FontAttributes="Bold" />
                    
                    <Grid ColumnDefinitions="50,*,50" RowDefinitions="Auto,Auto">
                        <Label Grid.Column="0" 
                               Text="-80°" 
                               VerticalOptions="Center"
                               HorizontalOptions="Start" />
                        
                        <Slider Grid.Column="1"
                                Minimum="{Binding AzimuthMinimum}"
                                Maximum="{Binding AzimuthMaximum}"
                                Value="{Binding Azimuth}"
                                MinimumTrackColor="{StaticResource Primary}"
                                MaximumTrackColor="LightGray"
                                ThumbColor="{StaticResource Primary}" />
                        
                        <Label Grid.Column="2" 
                               Text="80°" 
                               VerticalOptions="Center"
                               HorizontalOptions="End" />
                        
                        <Label Grid.Row="1" Grid.ColumnSpan="3"
                               Text="{Binding AzimuthDisplay}"
                               FontSize="24"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource Primary}" />
                    </Grid>
                    
                    <Label Text="Negative = Left, Positive = Right"
                           FontSize="12"
                           TextColor="Gray"
                           HorizontalOptions="Center" />
                </VerticalStackLayout>
            </Frame>

            <!-- Elevation Control -->
            <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2D2D2D}"
                   Padding="20"
                   CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Elevation (Up/Down)"
                           FontSize="18"
                           FontAttributes="Bold" />
                    
                    <Grid ColumnDefinitions="50,*,50" RowDefinitions="Auto,Auto">
                        <Label Grid.Column="0" 
                               Text="-45°" 
                               VerticalOptions="Center"
                               HorizontalOptions="Start" />
                        
                        <Slider Grid.Column="1"
                                Minimum="{Binding ElevationMinimum}"
                                Maximum="{Binding ElevationMaximum}"
                                Value="{Binding Elevation}"
                                MinimumTrackColor="{StaticResource Elevation}"
                                MaximumTrackColor="LightGray"
                                ThumbColor="{StaticResource Elevation}" />
                        
                        <Label Grid.Column="2" 
                               Text="231°" 
                               VerticalOptions="Center"
                               HorizontalOptions="End" />
                        
                        <Label Grid.Row="1" Grid.ColumnSpan="3"
                               Text="{Binding ElevationDisplay}"
                               FontSize="24"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource Elevation}" />
                    </Grid>
                    
                    <Label Text="0° = Ear level, 90° = Above, 180° = Behind"
                           FontSize="12"
                           TextColor="Gray"
                           HorizontalOptions="Center" />
                </VerticalStackLayout>
            </Frame>

            <!-- Crossover Filter Control -->
            <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2D2D2D}"
                   Padding="20"
                   CornerRadius="10">
                <VerticalStackLayout Spacing="10">
                    <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                        <CheckBox IsChecked="{Binding UseCrossover}"
                                  Color="{StaticResource Primary}" />
                        <Label Text="Use Crossover Filter"
                               FontSize="16"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>
                    
                    <HorizontalStackLayout Spacing="10" 
                                           HorizontalOptions="Center"
                                           IsVisible="{Binding UseCrossover}">
                        <Label Text="Frequency:"
                               VerticalOptions="Center" />
                        <Entry Text="{Binding CrossoverFrequency}"
                               Keyboard="Numeric"
                               WidthRequest="80"
                               HorizontalTextAlignment="Center" />
                        <Label Text="Hz"
                               VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Quick Position Buttons -->
            <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2D2D2D}"
                   Padding="20"
                   CornerRadius="10">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Quick Positions"
                           FontSize="18"
                           FontAttributes="Bold"
                           HorizontalOptions="Center" />
                    
                    <FlexLayout JustifyContent="Center" 
                                Wrap="Wrap" 
                                AlignItems="Center">
                        <Button Text="Front"
                                Clicked="OnFrontClicked"
                                Margin="5"
                                WidthRequest="100" />
                        <Button Text="Left"
                                Clicked="OnLeftClicked"
                                Margin="5"
                                WidthRequest="100" />
                        <Button Text="Right"
                                Clicked="OnRightClicked"
                                Margin="5"
                                WidthRequest="100" />
                        <Button Text="Above"
                                Clicked="OnAboveClicked"
                                Margin="5"
                                WidthRequest="100" />
                        <Button Text="Behind"
                                Clicked="OnBehindClicked"
                                Margin="5"
                                WidthRequest="100" />
                    </FlexLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Audio File Selection -->
            <Frame BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2D2D2D}"
                   Padding="20"
                   CornerRadius="10">
                <VerticalStackLayout Spacing="15">
                    <Label Text="Audio File"
                           FontSize="18"
                           FontAttributes="Bold"
                           HorizontalOptions="Center" />
                    
                    <Label Text="{Binding CurrentAudioFileName}"
                           FontSize="14"
                           TextColor="Gray"
                           HorizontalOptions="Center"
                           LineBreakMode="TailTruncation" />
                    
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <Button Grid.Column="0"
                                Text="Select File"
                                Clicked="OnSelectAudioFileClicked" />
                        <Button Grid.Column="1"
                                Text="Play"
                                Clicked="OnPlayAudioClicked" />
                    </Grid>
                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
